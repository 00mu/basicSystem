<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MVVM 浅聊 | WEB 前端基础体系梳理</title>
    <meta name="description" content="进化中...">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/basicSystem/assets/css/0.styles.978a8c4c.css" as="style"><link rel="preload" href="/basicSystem/assets/js/app.fe57eed6.js" as="script"><link rel="preload" href="/basicSystem/assets/js/3.40885dd2.js" as="script"><link rel="preload" href="/basicSystem/assets/js/12.aff4d014.js" as="script"><link rel="prefetch" href="/basicSystem/assets/js/10.8f192e07.js"><link rel="prefetch" href="/basicSystem/assets/js/11.70ea7752.js"><link rel="prefetch" href="/basicSystem/assets/js/13.0bf7b953.js"><link rel="prefetch" href="/basicSystem/assets/js/14.965f889e.js"><link rel="prefetch" href="/basicSystem/assets/js/15.54ac762d.js"><link rel="prefetch" href="/basicSystem/assets/js/16.6b7d15a8.js"><link rel="prefetch" href="/basicSystem/assets/js/17.4f9c33ec.js"><link rel="prefetch" href="/basicSystem/assets/js/18.e7829a1b.js"><link rel="prefetch" href="/basicSystem/assets/js/19.a14098a6.js"><link rel="prefetch" href="/basicSystem/assets/js/20.9cdf8898.js"><link rel="prefetch" href="/basicSystem/assets/js/21.52406625.js"><link rel="prefetch" href="/basicSystem/assets/js/22.5a250bd9.js"><link rel="prefetch" href="/basicSystem/assets/js/23.b68348d6.js"><link rel="prefetch" href="/basicSystem/assets/js/24.06a02506.js"><link rel="prefetch" href="/basicSystem/assets/js/25.09a10bf9.js"><link rel="prefetch" href="/basicSystem/assets/js/26.298e26d0.js"><link rel="prefetch" href="/basicSystem/assets/js/27.ba9538a8.js"><link rel="prefetch" href="/basicSystem/assets/js/28.4f67f474.js"><link rel="prefetch" href="/basicSystem/assets/js/29.4bea42c4.js"><link rel="prefetch" href="/basicSystem/assets/js/30.90e696e0.js"><link rel="prefetch" href="/basicSystem/assets/js/31.69c8c548.js"><link rel="prefetch" href="/basicSystem/assets/js/32.5309047d.js"><link rel="prefetch" href="/basicSystem/assets/js/33.5b269816.js"><link rel="prefetch" href="/basicSystem/assets/js/34.90d75a26.js"><link rel="prefetch" href="/basicSystem/assets/js/35.e1f8a67a.js"><link rel="prefetch" href="/basicSystem/assets/js/36.1224f9ef.js"><link rel="prefetch" href="/basicSystem/assets/js/37.514fe7f4.js"><link rel="prefetch" href="/basicSystem/assets/js/38.8691a21e.js"><link rel="prefetch" href="/basicSystem/assets/js/39.43c15237.js"><link rel="prefetch" href="/basicSystem/assets/js/4.616c069e.js"><link rel="prefetch" href="/basicSystem/assets/js/40.341eebc6.js"><link rel="prefetch" href="/basicSystem/assets/js/41.61141311.js"><link rel="prefetch" href="/basicSystem/assets/js/42.096b0e5b.js"><link rel="prefetch" href="/basicSystem/assets/js/43.08c8940b.js"><link rel="prefetch" href="/basicSystem/assets/js/44.972fa1ee.js"><link rel="prefetch" href="/basicSystem/assets/js/45.18b164ae.js"><link rel="prefetch" href="/basicSystem/assets/js/46.c5084eb9.js"><link rel="prefetch" href="/basicSystem/assets/js/47.5a081ac6.js"><link rel="prefetch" href="/basicSystem/assets/js/48.1dfe435d.js"><link rel="prefetch" href="/basicSystem/assets/js/49.9591def2.js"><link rel="prefetch" href="/basicSystem/assets/js/5.75c0cb05.js"><link rel="prefetch" href="/basicSystem/assets/js/50.42d39276.js"><link rel="prefetch" href="/basicSystem/assets/js/51.2ce3513a.js"><link rel="prefetch" href="/basicSystem/assets/js/52.7d8bbb55.js"><link rel="prefetch" href="/basicSystem/assets/js/53.a9481449.js"><link rel="prefetch" href="/basicSystem/assets/js/54.cdf677e4.js"><link rel="prefetch" href="/basicSystem/assets/js/55.19599d18.js"><link rel="prefetch" href="/basicSystem/assets/js/56.f10f47fa.js"><link rel="prefetch" href="/basicSystem/assets/js/57.e3bb2ba8.js"><link rel="prefetch" href="/basicSystem/assets/js/58.4ffe555a.js"><link rel="prefetch" href="/basicSystem/assets/js/59.a549b1ff.js"><link rel="prefetch" href="/basicSystem/assets/js/6.2dd188fc.js"><link rel="prefetch" href="/basicSystem/assets/js/7.6a47198c.js"><link rel="prefetch" href="/basicSystem/assets/js/8.da290d25.js"><link rel="prefetch" href="/basicSystem/assets/js/9.b8c11fc3.js"><link rel="prefetch" href="/basicSystem/assets/js/vendors~docsearch.a3318253.js">
    <link rel="stylesheet" href="/basicSystem/assets/css/0.styles.978a8c4c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/basicSystem/" class="home-link router-link-active"><!----> <span class="site-name">WEB 前端基础体系梳理</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="手稿" class="dropdown-title"><span class="title">手稿</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础语法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-subitem"><a href="/basicSystem/basic/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/basicSystem/basic/CSS/" class="nav-link">
  CSS
</a></li></ul></li><li class="dropdown-item"><h4>
          MVVM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/mvvm/VUE/" class="nav-link">
  VUE
</a></li><li class="dropdown-subitem"><a href="/basicSystem/mvvm/React/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/basicSystem/mvvm/Electron/" class="nav-link">
  Electron
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/webpack/" class="nav-link">
  webpack
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/basicSystem/deepLearning/" class="nav-link router-link-active">
  专题
</a></div><div class="nav-item"><a href="/basicSystem/coding/" class="nav-link">
  Coding
</a></div><div class="nav-item"><a href="/basicSystem/interview/" class="nav-link">
  考点
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          编辑器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/soft/git.html" class="nav-link">
  GIT
</a></li><li class="dropdown-subitem"><a href="/basicSystem/soft/vscode/" class="nav-link">
  VSCODE
</a></li></ul></li><li class="dropdown-item"><h4>
          效率工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/deepLearning/figma.com.html" class="nav-link">
  figma
</a></li></ul></li></ul></div></div> <a href="https://github.com/bbzz/basicSystem" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="手稿" class="dropdown-title"><span class="title">手稿</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础语法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-subitem"><a href="/basicSystem/basic/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/basicSystem/basic/CSS/" class="nav-link">
  CSS
</a></li></ul></li><li class="dropdown-item"><h4>
          MVVM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/mvvm/VUE/" class="nav-link">
  VUE
</a></li><li class="dropdown-subitem"><a href="/basicSystem/mvvm/React/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/basicSystem/mvvm/Electron/" class="nav-link">
  Electron
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/webpack/" class="nav-link">
  webpack
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/basicSystem/deepLearning/" class="nav-link router-link-active">
  专题
</a></div><div class="nav-item"><a href="/basicSystem/coding/" class="nav-link">
  Coding
</a></div><div class="nav-item"><a href="/basicSystem/interview/" class="nav-link">
  考点
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          编辑器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/soft/git.html" class="nav-link">
  GIT
</a></li><li class="dropdown-subitem"><a href="/basicSystem/soft/vscode/" class="nav-link">
  VSCODE
</a></li></ul></li><li class="dropdown-item"><h4>
          效率工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basicSystem/deepLearning/figma.com.html" class="nav-link">
  figma
</a></li></ul></li></ul></div></div> <a href="https://github.com/bbzz/basicSystem" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/basicSystem/deepLearning/" class="sidebar-link">百篇专题计划</a></li><li><a href="/basicSystem/deepLearning/conversion.html" class="sidebar-link">01 数据类型转换</a></li><li><a href="/basicSystem/deepLearning/scope.html" class="sidebar-link">02 函数作用域与闭包</a></li><li><a href="/basicSystem/deepLearning/prototype.html" class="sidebar-link">03 原型与原型链</a></li><li><a href="/basicSystem/deepLearning/this.html" class="sidebar-link">04 this、call、apply、bind</a></li><li><a href="/basicSystem/deepLearning/eventLoop.html" class="sidebar-link">05 JavaScript 运行机制</a></li><li><a href="/basicSystem/deepLearning/render.html" class="sidebar-link">06 浏览器渲染原理</a></li><li><a href="/basicSystem/deepLearning/http.html" class="sidebar-link">待续 前后端通信</a></li><li><a href="/basicSystem/deepLearning/async.html" class="sidebar-link">待续 异步</a></li><li><a href="/basicSystem/deepLearning/cssModel.html" class="sidebar-link">待续 CSS 文档流 盒模型</a></li><li><a href="/basicSystem/deepLearning/optimization.html" class="sidebar-link">待续 性能优化</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mvvm-浅聊"><a href="#mvvm-浅聊" class="header-anchor">#</a> MVVM 浅聊</h1> <ul><li>画架构图？ 架构师啊原来
架构组</li> <li>提供基础的组件</li> <li></li></ul> <h2 id="mvvm-模式-目标"><a href="#mvvm-模式-目标" class="header-anchor">#</a> MVVM 模式 - 目标</h2> <p>最符合的现代 UI 的模式</p> <ul><li>view 层的组件有一定的输入和反馈能力</li> <li>每一个组件都来自 UI 库</li> <li>组装是由完全声明式的代码完成的</li> <li>model 层的编写是完全自由的，和 view 完全无关 ，modle 其中是普通的 JS 对象</li></ul> <p>view &lt;=&gt; viewModle -&gt; model</p> <h2 id="viewmodle-是什么？"><a href="#viewmodle-是什么？" class="header-anchor">#</a> viewModle 是什么？</h2> <p>是链接 view 和 model 层的胶水，连接层，写的 vue 可以称之为 vm</p> <p>数据和视图的绑定</p> <h2 id="modle-要怎么写？"><a href="#modle-要怎么写？" class="header-anchor">#</a> modle 要怎么写？</h2> <p>modle 层不应该知道 view 和 viewmodle 的存在</p> <p>在一些场景下，modle 可能是已经存在但是与 UI 无关的代码</p> <p>一个合格的 mvvm 框架应该能够以极低的成本为这些 modle 提供展示和操作的能力</p> <h2 id="代码得跟着写一遍才行"><a href="#代码得跟着写一遍才行" class="header-anchor">#</a> 代码得跟着写一遍才行</h2> <p>vue3.0 的环境还不是好配</p> <h2 id="mixin-的问题？是什么"><a href="#mixin-的问题？是什么" class="header-anchor">#</a> mixin 的问题？是什么</h2> <h2 id="typescript-越复杂月应该使用这个"><a href="#typescript-越复杂月应该使用这个" class="header-anchor">#</a> typescript 越复杂月应该使用这个</h2> <h2 id="vue3-0"><a href="#vue3-0" class="header-anchor">#</a> vue3.0</h2> <p>更新系统 和 响应系统</p> <ul><li><p>tree-shaking</p></li> <li><p>compositon API(新加)</p></li> <li><p>Fragments</p></li> <li><p>teleport</p></li> <li><p>suspense（sync 在将渲染树渲染到屏幕之前，内部先处理好所有的异步组件，然后在渲染到页面）</p></li> <li><p>为什么不推荐使用 class 的方式
混入(mixin) 将不再作为推荐使用， Composition API 可以实现更灵活且无副作用的复用代码</p></li></ul> <h2 id="响应式"><a href="#响应式" class="header-anchor">#</a> 响应式</h2> <p>ES5 Object.defineProperty() getter setter</p> <p>reat 事件拦截</p> <h3 id="响应"><a href="#响应" class="header-anchor">#</a> 响应</h3> <ul><li>getter</li> <li>setter</li></ul> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token comment">// 其实这就是一个observe函数</span>
<span class="token keyword">function</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> internalValue <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 闭包</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">gettiing key &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>internalValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> internalValue
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setting key &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        internalValue <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="跟踪依赖"><a href="#跟踪依赖" class="header-anchor">#</a> 跟踪依赖</h3> <p>订阅模式</p> <p>dep 类</p> <ol><li>dep =&gt; depend &amp; notify</li> <li>autorun</li></ol> <div class="language-JS extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>Dep <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">Dep</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 收集依赖</span>
  <span class="token function">deep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>activeUpdate<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 注册当前active UPdate 作为订阅者 subscriber</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>activeUpdate<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 通知</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// run all subscriber functions</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subscribers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token operator">=&gt;</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> activeUpdate<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">autorun</span><span class="token punctuation">(</span><span class="token parameter">update</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">wrappedUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    activeUpdate <span class="token operator">=</span> wrappedUpdate<span class="token punctuation">;</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    activeUpdate <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">autorun</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>简单实践版本不需要关心边界情况
、、</p> <p>总结以上三个函数，我们就搞定了一个 mini 的响应系统
observe 需要一个对象，监听它的 getter 和 setter，在 getter 和 setter 里面我么可以设置依赖，然后利用 dep 类和 autorun 函数和 depnotify；本质上我们创建了一个响应对象。</p> <p>当我们通过赋值和改变属性值，它调用 dep.notify 出发改变，这就是 vue 更新系统的工作原理。</p> <h2 id="插件的编写"><a href="#插件的编写" class="header-anchor">#</a> 插件的编写</h2> <p>vue.use()</p> <p>插件本质上也是一个函数</p> <p>Vue.mixin(options)</p> <p><code>$options</code> 实例属性</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myPlugin <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">minxin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>rules<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>foo<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
    foo<span class="token operator">:</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>$watch</code> 监听变化，执行一个回调</p> <p>vue-loader 构建时预编译模板</p> <h2 id="render"><a href="#render" class="header-anchor">#</a> render</h2> <ul><li>(compiled into ) render function 编译的渲染函数
<ol><li>returns new virtural DOM - new virtual dom</li> <li>diffed against old virtual -dom update</li> <li>applied to Actual DOM</li></ol></li> <li>(renturns) virtural DOM 虚拟 dom</li> <li>(gennerates) ACTUAL dOM 真实 dom</li></ul> <p>所有的 data 属性是具有响应性的，帮助组件的渲染函数收集依赖</p> <h3 id="actual-dom"><a href="#actual-dom" class="header-anchor">#</a> Actual dom</h3> <p><code>document.createElement('div')</code></p> <p>渲染出来是底层 c++编写的浏览器引擎实现，它只是提供了 JS 中的 API，供我们使用</p> <h3 id="virtual-dom"><a href="#virtual-dom" class="header-anchor">#</a> virtual dom</h3> <p><code>vm.$createElement('div')</code></p> <p>相比之下，vue 中的虚拟 dom 会在每个实例通过 this.$createElement 返回一个虚拟的节点，这个虚拟节点也表示一个 div</p> <p>JS DOM 相互调用的成本很高，修改 DOM 是缓慢的，尽管引擎做了优化</p> <p>虚拟 DOM，真正的价值不在于让框架变得更快，而是以声明的方式构成你想要的 DOM 结构。这提供了更过的可能，另一个好处是将 dom 逻辑从真实的 dom 中分离开来。so，我们并不一定渲染成 dom，让渲染到 ios 或者安卓或者服务端称为可能。</p> <p>当然虚拟 dom 并不是唯一可以实现的方式，但他是一个好的方式。</p> <p>最后。渲染函数，只是返回虚拟 dom 的函数</p> <p>templates 在 vuejs 是通过渲染函数编译的</p> <p><code>vue-template-explorer.now.sh</code></p> <p>每一个组件豆油一个负责监视的观察者，收集依赖项，清理并通知所有内容。</p> <p>渲染放在 antorun 中，自动循环渲染，每个组件都有自己的主动循环渲染</p> <p>组件树由许多这样的组件组成，每个组件都只负责自己的依赖</p> <p>这有一个优势，一个精确的依赖跟踪系统，摆脱渲染优化的问题。reat 是自上而下的渲染模型</p> <p>为此，我们花费了将数据转化为 getter 和 setter 的开销。</p> <h3 id="jsx-和-template"><a href="#jsx-和-template" class="header-anchor">#</a> JSX 和 template</h3> <p>其实是一回事，当我们在谈论他们的时候要考虑最终目标；他们都是一种声明 dom 的状态的关系。模板只是一种更静态？更受约束的表达形式； JSX 或渲染函数更加的动态，具有更大的灵活性，你可以做任何你想做的事，只要是代码可以实现的你都可以放在渲染函数中，可以摆脱新语法和模板的限制，以便完成更复杂的渲染要求。</p> <p>HTML 和模板语法接近，任何 html 解析器都可以解析它们，更加熟悉方便的还原设计，模板的静态性能更容易优化编译。</p> <p>vue 提供了两种方式，默认使用模板，你也可以选用 render function</p> <h3 id="render-function-api"><a href="#render-function-api" class="header-anchor">#</a> Render Function API</h3> <p>h 函数，称之为超脚本，只是一种惯例</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 第二个参数是各种各样的属性，并不是必须的</span>
<span class="token comment">// 第三个参数是各种子节点，包括文本节点或者组件节点</span>
</code></pre></div><p>组件节点</p> <div class="language-JS extra-class"><pre class="language-js"><code><span class="token keyword">import</span> MyCompontens form <span class="token string">&quot;..&quot;</span>
<span class="token function">h</span><span class="token punctuation">(</span>MyCompontens<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-JS extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>example <span class="token operator">:</span>tags<span class="token operator">=</span><span class="token string">&quot;['h1','h2', 'h3']&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>example<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

Vue<span class="token punctuation">.</span><span class="token function">compontent</span><span class="token punctuation">(</span><span class="token string">'example'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// render: h=&gt;h()</span>
  <span class="token comment">// 箭头函数的中 this 指向外部上下文，所以你拿不到</span>
  <span class="token comment">// 我们改写成普通函数</span>
  <span class="token comment">// render: function(h){}</span>
  <span class="token comment">// 简化下</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'tags'</span><span class="token punctuation">]</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tags<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">h</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>函数组件 有称之为 无状态组件</p> <p>普通组件支持实例化，函数组件不支持实例</p> <h3 id="高阶组件"><a href="#高阶组件" class="header-anchor">#</a> 高阶组件</h3> <p>有更强的复用性
更利于测试，和外部没有逻辑和耦合</p> <p>还记得高阶函数的定义吗？至少满足下面一个条件就是高级函数</p> <ul><li>函数作为参数</li> <li>函数作为返回值</li></ul> <div class="language-JS extra-class"><pre class="language-js"><code>高阶组件是一个方法，这个方法接收一个原始组件作为参数，并返回新的组件
</code></pre></div><p>有时 mixin 更容易使用</p> <div class="language-JS extra-class"><pre class="language-js"><code>
@装饰器
<span class="token keyword">function</span>
</code></pre></div><p>一个展示用户头衔的组件，是有个状态组件，他要保持状态，并负责 api 请求</p> <p>在 create 申明周期，只表示实例被创建，
montend，dom 被创建</p> <h2 id="状态管理"><a href="#状态管理" class="header-anchor">#</a> 状态管理</h2> <p>代码越来越多的时候，代码如何存放和状态如何管理的问题，查明问题越来约重要</p> <p>flux，单向数据流，就想眼睛一样，在需要的时候你自然知道改用他</p> <h3 id="vuex"><a href="#vuex" class="header-anchor">#</a> vuex</h3> <p>data 之所以使用函数，是因为我们希望每个组件的实例都有自己独立的唯一数据，而不是这些组件共享相同的数据。？</p> <p>自己用起来</p> <p>原理是基于 vue 实例实现响应性</p> <p>状态管理器</p> <p>高端花哨的库都是基于前端小点搞的</p> <h2 id="函数组件"><a href="#函数组件" class="header-anchor">#</a> 函数组件</h2> <p>最后我得说，其实『状态驱动』才是 Vue 的精髓所在</p> <h3 id="订阅-发布-设计模式搞明白"><a href="#订阅-发布-设计模式搞明白" class="header-anchor">#</a> 订阅-发布 设计模式搞明白</h3> <p>vue 中的是那个</p> <ul><li>observer（监听器）：</li> <li>watcher（订阅者）：</li> <li>compile（编译器）：</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/bbzz/basicSystem/edit/master/docs/deepLearning/MVVM.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/5/2020, 9:43:58 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/basicSystem/assets/js/app.fe57eed6.js" defer></script><script src="/basicSystem/assets/js/3.40885dd2.js" defer></script><script src="/basicSystem/assets/js/12.aff4d014.js" defer></script>
  </body>
</html>
